{"version":3,"names":["CallingCodePicker","initialCountryCode","onValueChange","togglerContainerStyle","togglerLabelStyle","listContainerStyle","listStyle","pickerItemLabelStyle","searchInputStyle","pickerItemContainerStyle","style","isFlagVisible","searchValue","setSearchValue","useState","isPickerOpen","setIsPickerOpen","countriesData","setCountriesData","sortData","countries","localCountryCode","find","f","alpha2Code","RNLocalize","getCountry","selectedCountry","setSelectedCountry","containerRef","createRef","toggleMeasure","setToggleMeasure","containerMeasure","setContainerMeasure","styles","useStyles","calculateModalVerticalPosition","handleCountrySelect","country","useEffect","newCountries","filter","s","callingCode","trim","toLowerCase","includes","name","renderPickerItem","renderItem","item","screenHeight","Dimensions","get","height","y","MODAL_SIZE","spacing","dismissPicker","onLayoutToggle","measure","flag","modalChild","dismissButton","keyboardAvoidingView","Platform","OS","listContainer","_","index","toString","ItemSeparator"],"sources":["index.tsx"],"sourcesContent":["import React, { createRef, useEffect, useState } from 'react';\nimport {\n  Dimensions,\n  FlatList,\n  KeyboardAvoidingView,\n  ListRenderItemInfo,\n  Modal,\n  Platform,\n  TouchableOpacity,\n  View,\n} from 'react-native';\nimport * as RNLocalize from 'react-native-localize';\nimport countries from '../../data/countries';\nimport { onLayoutToggle, sortData } from '../../functions/utility';\nimport { MODAL_SIZE, spacing } from '../../theme';\nimport { ICallingCodePickerProps, ICountry, IItemMeasure } from '../../types';\nimport ItemSeparator from '../ItemSeparator';\nimport PickerItem from '../PickerItem';\nimport PickerToggler from '../PickerToggler';\nimport Search from '../Search';\nimport useStyles from './styles';\n\nconst CallingCodePicker: React.FC<ICallingCodePickerProps> = ({\n  initialCountryCode,\n  onValueChange,\n  togglerContainerStyle,\n  togglerLabelStyle,\n  listContainerStyle,\n  listStyle,\n  pickerItemLabelStyle,\n  searchInputStyle,\n  pickerItemContainerStyle,\n  style,\n  isFlagVisible = true,\n}) => {\n  const [searchValue, setSearchValue] = useState<string>('');\n  const [isPickerOpen, setIsPickerOpen] = useState<boolean>(false);\n  const [countriesData, setCountriesData] = useState<ICountry[]>(sortData(countries, ''));\n  const localCountryCode = countries.find(f => f.alpha2Code === RNLocalize.getCountry());\n  const [selectedCountry, setSelectedCountry] = useState<ICountry | undefined>(\n    initialCountryCode\n      ? countries.find(f => f.alpha2Code === initialCountryCode) ?? localCountryCode\n      : localCountryCode,\n  );\n  const containerRef = createRef<View>();\n  const [toggleMeasure, setToggleMeasure] = useState<IItemMeasure>();\n  const [containerMeasure, setContainerMeasure] = useState<IItemMeasure>();\n  const styles = useStyles(calculateModalVerticalPosition());\n\n  const handleCountrySelect = (country: ICountry) => {\n    setSelectedCountry(country);\n    setIsPickerOpen(false);\n    setSearchValue('');\n  };\n\n  useEffect(() => {\n    let newCountries = countries.filter(\n      s =>\n        s.callingCode === searchValue.trim() ||\n        s.alpha2Code.trim().toLowerCase().includes(searchValue.trim().toLowerCase()) ||\n        s.name.trim().toLowerCase().includes(searchValue.trim().toLowerCase()),\n    );\n\n    newCountries = sortData(newCountries, searchValue);\n\n    setCountriesData(newCountries);\n  }, [searchValue]);\n\n  const renderPickerItem = (renderItem: ListRenderItemInfo<ICountry>) => {\n    const { item: country } = renderItem;\n    return (\n      <PickerItem\n        country={country}\n        onCountrySelect={handleCountrySelect}\n        textStyle={pickerItemLabelStyle}\n        containerStyle={pickerItemContainerStyle}\n      />\n    );\n  };\n\n  function calculateModalVerticalPosition() {\n    const screenHeight = Dimensions.get('window').height;\n    const y = (containerMeasure?.y ?? 0) + (toggleMeasure?.height ?? 0);\n\n    return y + MODAL_SIZE > screenHeight ? screenHeight - MODAL_SIZE - 2 * spacing.s : y;\n  }\n\n  useEffect(() => {\n    onValueChange(selectedCountry?.callingCode);\n  }, [selectedCountry, onValueChange]);\n\n  function dismissPicker() {\n    setIsPickerOpen(false);\n    setSearchValue('');\n  }\n\n  return (\n    <View\n      style={style}\n      ref={containerRef}\n      onLayout={() => onLayoutToggle(containerRef, measure => setContainerMeasure(measure))}\n    >\n      <PickerToggler\n        flag={selectedCountry?.flag}\n        selectedCode={selectedCountry?.callingCode}\n        isPickerOpen={isPickerOpen}\n        onPickerToggle={setIsPickerOpen}\n        containerStyle={togglerContainerStyle}\n        textStyle={togglerLabelStyle}\n        onLayout={measure => setToggleMeasure(measure)}\n        isFlagVisible={isFlagVisible}\n      />\n      <Modal visible={isPickerOpen} transparent animationType=\"fade\">\n        <View style={styles.modalChild}>\n          <TouchableOpacity style={styles.dismissButton} onPress={dismissPicker} />\n          <KeyboardAvoidingView\n            behavior=\"position\"\n            style={styles.keyboardAvoidingView}\n            keyboardVerticalOffset={Platform.OS === 'ios' ? 10 : -60}\n          >\n            <View style={listContainerStyle ?? styles.listContainer}>\n              <Search\n                value={searchValue}\n                onChangeText={setSearchValue}\n                onClearInput={() => setSearchValue('')}\n                inputStyle={searchInputStyle}\n              />\n              <FlatList\n                data={countriesData}\n                renderItem={renderPickerItem}\n                keyExtractor={(_, index) => index.toString()}\n                showsVerticalScrollIndicator={false}\n                style={listStyle}\n                ItemSeparatorComponent={ItemSeparator}\n                keyboardShouldPersistTaps=\"always\"\n              />\n            </View>\n          </KeyboardAvoidingView>\n        </View>\n      </Modal>\n    </View>\n  );\n};\n\nexport default CallingCodePicker;\n"],"mappings":"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"}