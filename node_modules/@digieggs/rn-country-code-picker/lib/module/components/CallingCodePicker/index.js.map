{"version":3,"names":["React","createRef","useEffect","useState","Dimensions","FlatList","KeyboardAvoidingView","Modal","Platform","TouchableOpacity","View","RNLocalize","countries","onLayoutToggle","sortData","MODAL_SIZE","spacing","ItemSeparator","PickerItem","PickerToggler","Search","useStyles","CallingCodePicker","initialCountryCode","onValueChange","togglerContainerStyle","togglerLabelStyle","listContainerStyle","listStyle","pickerItemLabelStyle","searchInputStyle","pickerItemContainerStyle","style","isFlagVisible","searchValue","setSearchValue","isPickerOpen","setIsPickerOpen","countriesData","setCountriesData","localCountryCode","find","f","alpha2Code","getCountry","selectedCountry","setSelectedCountry","containerRef","toggleMeasure","setToggleMeasure","containerMeasure","setContainerMeasure","styles","calculateModalVerticalPosition","handleCountrySelect","country","newCountries","filter","s","callingCode","trim","toLowerCase","includes","name","renderPickerItem","renderItem","item","screenHeight","get","height","y","dismissPicker","measure","flag","modalChild","dismissButton","keyboardAvoidingView","OS","listContainer","_","index","toString"],"sources":["index.tsx"],"sourcesContent":["import React, { createRef, useEffect, useState } from 'react';\nimport {\n  Dimensions,\n  FlatList,\n  KeyboardAvoidingView,\n  ListRenderItemInfo,\n  Modal,\n  Platform,\n  TouchableOpacity,\n  View,\n} from 'react-native';\nimport * as RNLocalize from 'react-native-localize';\nimport countries from '../../data/countries';\nimport { onLayoutToggle, sortData } from '../../functions/utility';\nimport { MODAL_SIZE, spacing } from '../../theme';\nimport { ICallingCodePickerProps, ICountry, IItemMeasure } from '../../types';\nimport ItemSeparator from '../ItemSeparator';\nimport PickerItem from '../PickerItem';\nimport PickerToggler from '../PickerToggler';\nimport Search from '../Search';\nimport useStyles from './styles';\n\nconst CallingCodePicker: React.FC<ICallingCodePickerProps> = ({\n  initialCountryCode,\n  onValueChange,\n  togglerContainerStyle,\n  togglerLabelStyle,\n  listContainerStyle,\n  listStyle,\n  pickerItemLabelStyle,\n  searchInputStyle,\n  pickerItemContainerStyle,\n  style,\n  isFlagVisible = true,\n}) => {\n  const [searchValue, setSearchValue] = useState<string>('');\n  const [isPickerOpen, setIsPickerOpen] = useState<boolean>(false);\n  const [countriesData, setCountriesData] = useState<ICountry[]>(sortData(countries, ''));\n  const localCountryCode = countries.find(f => f.alpha2Code === RNLocalize.getCountry());\n  const [selectedCountry, setSelectedCountry] = useState<ICountry | undefined>(\n    initialCountryCode\n      ? countries.find(f => f.alpha2Code === initialCountryCode) ?? localCountryCode\n      : localCountryCode,\n  );\n  const containerRef = createRef<View>();\n  const [toggleMeasure, setToggleMeasure] = useState<IItemMeasure>();\n  const [containerMeasure, setContainerMeasure] = useState<IItemMeasure>();\n  const styles = useStyles(calculateModalVerticalPosition());\n\n  const handleCountrySelect = (country: ICountry) => {\n    setSelectedCountry(country);\n    setIsPickerOpen(false);\n    setSearchValue('');\n  };\n\n  useEffect(() => {\n    let newCountries = countries.filter(\n      s =>\n        s.callingCode === searchValue.trim() ||\n        s.alpha2Code.trim().toLowerCase().includes(searchValue.trim().toLowerCase()) ||\n        s.name.trim().toLowerCase().includes(searchValue.trim().toLowerCase()),\n    );\n\n    newCountries = sortData(newCountries, searchValue);\n\n    setCountriesData(newCountries);\n  }, [searchValue]);\n\n  const renderPickerItem = (renderItem: ListRenderItemInfo<ICountry>) => {\n    const { item: country } = renderItem;\n    return (\n      <PickerItem\n        country={country}\n        onCountrySelect={handleCountrySelect}\n        textStyle={pickerItemLabelStyle}\n        containerStyle={pickerItemContainerStyle}\n      />\n    );\n  };\n\n  function calculateModalVerticalPosition() {\n    const screenHeight = Dimensions.get('window').height;\n    const y = (containerMeasure?.y ?? 0) + (toggleMeasure?.height ?? 0);\n\n    return y + MODAL_SIZE > screenHeight ? screenHeight - MODAL_SIZE - 2 * spacing.s : y;\n  }\n\n  useEffect(() => {\n    onValueChange(selectedCountry?.callingCode);\n  }, [selectedCountry, onValueChange]);\n\n  function dismissPicker() {\n    setIsPickerOpen(false);\n    setSearchValue('');\n  }\n\n  return (\n    <View\n      style={style}\n      ref={containerRef}\n      onLayout={() => onLayoutToggle(containerRef, measure => setContainerMeasure(measure))}\n    >\n      <PickerToggler\n        flag={selectedCountry?.flag}\n        selectedCode={selectedCountry?.callingCode}\n        isPickerOpen={isPickerOpen}\n        onPickerToggle={setIsPickerOpen}\n        containerStyle={togglerContainerStyle}\n        textStyle={togglerLabelStyle}\n        onLayout={measure => setToggleMeasure(measure)}\n        isFlagVisible={isFlagVisible}\n      />\n      <Modal visible={isPickerOpen} transparent animationType=\"fade\">\n        <View style={styles.modalChild}>\n          <TouchableOpacity style={styles.dismissButton} onPress={dismissPicker} />\n          <KeyboardAvoidingView\n            behavior=\"position\"\n            style={styles.keyboardAvoidingView}\n            keyboardVerticalOffset={Platform.OS === 'ios' ? 10 : -60}\n          >\n            <View style={listContainerStyle ?? styles.listContainer}>\n              <Search\n                value={searchValue}\n                onChangeText={setSearchValue}\n                onClearInput={() => setSearchValue('')}\n                inputStyle={searchInputStyle}\n              />\n              <FlatList\n                data={countriesData}\n                renderItem={renderPickerItem}\n                keyExtractor={(_, index) => index.toString()}\n                showsVerticalScrollIndicator={false}\n                style={listStyle}\n                ItemSeparatorComponent={ItemSeparator}\n                keyboardShouldPersistTaps=\"always\"\n              />\n            </View>\n          </KeyboardAvoidingView>\n        </View>\n      </Modal>\n    </View>\n  );\n};\n\nexport default CallingCodePicker;\n"],"mappings":"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"}